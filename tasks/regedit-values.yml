##########################
##########################
## CIS LEVEL 1 SETTINGS ##
##########################
##########################

- name: "18.1.1.1,CCE-38347-1 | Ensure 'Prevent enabling lock screen camera' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Personalization
    name: "NoLockScreenCamera"
    data: "1"
    type: dword

- name: "18.1.1.2,CCE-38348-9 | Ensure 'Prevent enabling lock screen slide show' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Personalization
    name: "NoLockScreenSlideshow"
    data: "1"
    type: dword

- name: "18.1.2.2,CCE-Null | Ensure 'Allow users to enable online speech recognition services' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\InputPersonalization
    name: "AllowInputPersonalization"
    data: "0"
    type: dword

- name: "18.3.1,CCE-37069-2 | Ensure 'Apply UAC restrictions to local accounts on network logons' is set to 'Disabled' (ITS Changed)"
  win_regedit:
    path: HKLM:\Software\Microsoft\Windows\Currentversion\Policies\System
    name: "LocalAccountTokenFilterPolicy"
    data: "1"
    type: dword

- name: "18.3.2,CCE-Null | Ensure 'Configure SMB v1 client driver' is set to 'Enabled - Disable driver (recommended)'"
  win_regedit:
    path: HKLM:\System\CurrentControlSet\Services\mrxsmb10
    name: "Start"
    data: "4"
    type: dword

- name: "18.3.3,CCE-Null | Ensure 'Configure SMB v1 server' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\System\CurrentControlSet\Services\LanmanServer\Parameters
    name: "SMB1"
    data: "0"
    type: dword

- name: "18.3.4,CCE-Null | Ensure 'Enable Structured Exception Handling Overwrite Protection (SEHOP)' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\System\CurrentControlSet\Control\Session Manager\kernel
    name: "DisableExceptionChainValidation"
    data: "0"
    type: dword

- name: "18.3.6,CCE-Null | Ensure 'NetBT NodeType configuration' is set to 'Enabled - P-node (recommended)'"
  win_regedit:
    path: HKLM:\System\CurrentControlSet\Services\NetBT\Parameters
    name: "NodeType"
    data: "2"
    type: dword

- name: "18.3.7,CCE-38444-6 | Ensure 'WDigest Authentication' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\System\Currentcontrolset\Control\Securityproviders\Wdigest
    name: "UseLogonCredential"
    data: "0"
    type: dword

- name: "18.4.1,CCE-37067-6 | Ensure 'MSS - (AutoAdminLogon) Enable Automatic Logon (not recommended)' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Microsoft\Windows Nt\Currentversion\Winlogon
    name: "AutoAdminLogon"
    data: "0"
    type: string

- name: "18.4.2,CCE-36871-2 | Ensure 'MSS - (DisableIPSourceRouting IPv6) IP source routing protection level (protects against packet spoofing)' is set"
  win_regedit:
    path: HKLM:\System\Currentcontrolset\Services\Tcpip6\Parameters
    name: "DisableIPSourceRouting"
    data: "2"
    type: dword

- name: "18.4.3,CCE-36535-3 | Ensure 'MSS - (DisableIPSourceRouting) IP source routing protection level (protects against packet spoofing)' is set"
  win_regedit:
    path: HKLM:\System\Currentcontrolset\Services\Tcpip\Parameters
    name: "DisableIPSourceRouting"
    data: "2"
    type: dword

- name: "18.4.4,CCE-37988-3 | Ensure 'MSS - (EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\System\Currentcontrolset\Services\Tcpip\Parameters
    name: "EnableICMPRedirect"
    data: "0"
    type: dword

- name: "18.4.6,CCE-36879-5 | Ensure 'MSS - (NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers' is set"
  win_regedit:
    path: HKLM:\System\Currentcontrolset\Services\Netbt\Parameters
    name: "nonamereleaseondemand"
    data: "1"
    type: dword

- name: "18.4.8,CCE-36351-5 | Ensure 'MSS - (SafeDllSearchMode) Enable Safe DLL search mode (recommended)' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\System\Currentcontrolset\Control\Session Manager
    name: "SafeDllSearchMode"
    data: "1"
    type: dword

- name: "18.4.9,CCE-37993-3 | Ensure 'MSS - (ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires (0 recommended)' is set to 'Enabled - 5 or fewer seconds'"
  win_regedit:
    path: HKLM:\Software\Microsoft\Windows Nt\Currentversion\Winlogon
    name: "ScreenSaverGracePeriod"
    data: "5"
    type: string

- name: "18.4.12,CCE-36880-3 | Ensure 'MSS - (WarningLevel) Percentage threshold for the security event log at which the system will generate a warning' is set"
  win_regedit:
    path: HKLM:\System\Currentcontrolset\Services\Eventlog\Security
    name: "WarningLevel"
    data: "90"
    type: dword

- name: "18.5.4.1,CCE-37450-4 | Ensure 'Turn off multicast name resolution' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows NT\DNSClient
    name: "EnableMulticast"
    data: "0"
    type: dword

- name: "18.5.8.1,CCE-Null | Ensure 'Enable insecure guest logons' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Lanmanworkstation
    name: "AllowInsecureGuestAuth"
    data: "0"
    type: dword

- name: "18.5.11.2,CCE-38002-2 | Ensure 'Prohibit installation and configuration of Network Bridge on your DNS domain network' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Network Connections
    name: "NC_AllowNetBridge_NLA"
    data: "0"
    type: dword

- name: "18.5.11.3,CCE-Null | Ensure 'Prohibit use of Internet Connection Sharing on your DNS domain network' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Network Connections
    name: "NC_ShowSharedAccessUI"
    data: "0"
    type: dword

- name: "18.5.11.4,CCE-38188-9 | Ensure 'Require domain users to elevate when setting a network's location' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Network Connections
    name: "NC_StdDomainUserSetLocation"
    data: "1"
    type: dword

- name: "18.5.14.1,CCE-Null | Hardened UNC Paths is set to 'Enabled, with 'Require Mutual Authentication' and 'Require Integrity' set for NETLOGON shares'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Networkprovider\Hardenedpaths
    name: "\\\\*\\NETLOGON"
    data: "RequireMutualAuthentication=1, RequireIntegrity=1"
    type: string

- name: "18.5.14.1,CCE-Null | Hardened UNC Paths is set to 'Enabled, with 'Require Mutual Authentication' and 'Require Integrity' set for SYSVOL shares'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Networkprovider\Hardenedpaths
    name: "\\\\*\\SYSVOL"
    data: "RequireMutualAuthentication=1, RequireIntegrity=1"
    type: string

- name: "18.5.21.1,CCE-38338-0 | Ensure 'Minimize the number of simultaneous connections to the Internet or a Windows Domain' is set to 'Enabled - 3 = Prevent Wi-Fi when on Ethernet'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Wcmsvc\Grouppolicy
    name: "fMinimizeConnections"
    data: "3"
    type: dword

- name: "18.8.3.1,CCE-36925-6 | Ensure 'Include command line in process creation events' is set to 'Disabled' [ITS-Enabled]"
  win_regedit:
    path: HKLM:\Software\Microsoft\Windows\Currentversion\Policies\System\Audit
    name: "ProcessCreationIncludeCmdLine_Enabled"
    data: "0"
    type: dword

- name: "18.8.4.1,CCE-Null | Ensure 'Encryption Oracle Remediation' is set to 'Enabled - Force Updated Clients'"
  win_regedit:
    path: HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters
    name: "AllowEncryptionOracle"
    data: "0"
    type: dword

- name: "18.8.4.2,CCE-Null | Ensure 'Remote host allows delegation of non-exportable credentials' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\CredentialsDelegation
    name: "AllowProtectedCreds"
    data: "1"
    type: dword

- name: "18.8.14.1,CCE-37912-3 | Ensure 'Boot-Start Driver Initialization Policy' is set to 'Enabled - Good, unknown and bad but critical'"
  win_regedit:
    path: HKLM:\System\Currentcontrolset\Policies\Earlylaunch
    name: "DriverLoadPolicy"
    data: "3"
    type: dword

- name: "18.8.21.2,CCE-36169-1 | Ensure 'Configure registry policy processing - Do not apply during periodic background processing' is set to 'Enabled - FALSE'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Group Policy\{35378Eac-683F-11D2-A89A-00C04Fbbcfa2}
    name: "NoBackgroundPolicy"
    data: "0"
    type: dword

- name: "18.8.21.3,CCE-36169-1 | Ensure 'Configure registry policy processing - Process even if the Group Policy objects have not changed' is set to 'Enabled - TRUE'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Group Policy\{35378Eac-683F-11D2-A89A-00C04Fbbcfa2}
    name: "NoGPOListChanges"
    data: "0"
    type: dword

- name: "18.8.21.4,CCE-Null | Ensure 'Continue experiences on this device' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
    name: "EnableCdp"
    data: "0"
    type: dword

- name: "18.8.21.5,CCE-37712-7 | Ensure 'Turn off background refresh of Group Policy' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Microsoft\Windows\Currentversion\Policies\System\DisableBkGndGroupPolicy
    state: absent
    delete_key: yes

- name: "18.8.22.1.1,CCE-36625-2 | Ensure 'Turn off downloading of print drivers over HTTP' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Nt\Printers
    name: "DisableWebPnPDownload"
    data: "1"
    type: dword

- name: "18.8.22.1.5,CCE-36096-6 | Ensure 'Turn off Internet download for Web publishing and online ordering wizards' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Microsoft\Windows\Currentversion\Policies\Explorer
    name: "NoWebServices"
    data: "1"
    type: dword

- name: "18.8.26.1,CCE-Null | Ensure 'Enumeration policy for external devices incompatible with Kernel DMA Protection' is set to 'Enabled - Block All'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Kernel DMA Protection
    name: "DeviceEnumerationPolicy"
    data: "0"
    type: dword

- name: "18.8.28.1,CCE-Null | Ensure 'Block user from showing account details on sign-in' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\System
    name: "BlockUserFromShowingAccountDetailsOnSignin"
    data: "1"
    type: dword

- name: "18.8.28.2,CCE-38353-9 | Ensure 'Do not display network selection UI' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\System
    name: "DontDisplayNetworkSelectionUI"
    data: "1"
    type: dword

- name: "18.8.28.3,CCE-37838-0 | Ensure 'Do not enumerate connected users on domain-joined computers' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\System
    name: "DontEnumerateConnectedUsers"
    data: "1"
    type: dword

- name: "18.8.28.4,CCE-35894-5 | Ensure 'Enumerate local users on domain-joined computers' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\System
    name: "EnumerateLocalUsers"
    data: "0"
    type: dword

- name: "18.8.28.5,CCE-35893-7 | Ensure 'Turn off app notifications on the lock screen' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\System
    name: "DisableLockScreenAppNotifications"
    data: "1"
    type: dword

- name: "18.8.28.6,CCE-37830-7 | Ensure 'Turn off picture password sign-in' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\System
    name: "BlockDomainPicturePassword"
    data: "1"
    type: dword

- name: "18.8.28.7,CCE-37528-7 | Ensure 'Turn on convenience PIN sign-in' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\System
    name: "AllowDomainPINLogon"
    data: "0"
    type: dword

- name: "18.8.34.6.3,CCE-36881-1 | Ensure 'Require a password when a computer wakes (on battery)' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Power\Powersettings\0E796Bdb-100D-47D6-A2D5-F7D2Daa51F51
    name: "DCSettingIndex"
    data: "1"
    type: dword

- name: "18.8.34.6.4,CCE-37066-8 | Ensure 'Require a password when a computer wakes (plugged in)' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Power\Powersettings\0E796Bdb-100D-47D6-A2D5-F7D2Daa51F51
    name: "ACSettingIndex"
    data: "1"
    type: dword

- name: "18.8.36.1,CCE-36388-7 | Ensure 'Configure Offer Remote Assistance' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Nt\Terminal Services
    name: "fAllowUnsolicited"
    data: "0"
    type: dword

- name: "18.8.36.2,CCE-37281-3 | Ensure 'Configure Solicited Remote Assistance' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Nt\Terminal Services
    name: "fAllowToGetHelp"
    data: "0"
    type: dword

- name: "18.8.37.1,CCE-37346-4 | Ensure 'Enable RPC Endpoint Mapper Client Authentication' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Nt\Rpc
    name: "EnableAuthEpResolution"
    data: "1"
    type: dword

- name: "18.9.6.1,CCE-38354-7 | Ensure 'Allow Microsoft accounts to be optional' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Microsoft\Windows\Currentversion\Policies\System
    name: "MSAOptional"
    data: "1"
    type: dword

- name: "18.9.8.1,CCE-37636-8 | Ensure 'Disallow Autoplay for non-volume devices' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Explorer
    name: "NoAutoplayfornonVolume"
    data: "1"
    type: dword

- name: "18.9.8.2,CCE-38217-6 | Ensure 'Set the default behavior for AutoRun' is set to 'Enabled - Do not execute any autorun commands'"
  win_regedit:
    path: HKLM:\Software\Microsoft\Windows\Currentversion\Policies\Explorer
    name: "NoAutorun"
    data: "1"
    type: dword

- name: "18.9.8.3,CCE-36875-3 | Ensure 'Turn off Autoplay' is set to 'Enabled - All drives'"
  win_regedit:
    path: HKLM:\Software\Microsoft\Windows\Currentversion\Policies\Explorer
    name: "NoDriveTypeAutoRun"
    data: "255"
    type: dword

- name: "18.9.10.1.1,CCE-Null | Ensure 'Use enhanced anti-spoofing when available' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Biometrics\Facialfeatures
    name: "EnhancedAntiSpoofing"
    data: "1"
    type: dword

- name: "18.9.13.1,CCE-Null | Ensure 'Turn off Microsoft consumer experiences' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Cloudcontent
    name: "DisableWindowsConsumerFeatures"
    data: "1"
    type: dword

- name: "18.9.14.1,CCE-Null | Ensure 'Require pin for pairing' is set to 'Enabled - First Time' OR 'Enabled - Always'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Connect
    name: "RequirePinForPairing"
    data: "1"
    type: dword

- name: "18.9.15.1,CCE-37534-5 | Ensure 'Do not display the password reveal button' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Credui
    name: "DisablePasswordReveal"
    data: "1"
    type: dword

- name: "18.9.15.2,CCE-36512-2 | Ensure 'Enumerate administrator accounts on elevation' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Microsoft\Windows\Currentversion\Policies\Credui
    name: "EnumerateAdministrators"
    data: "0"
    type: dword

- name: "18.9.16.1,CCE-Null | Ensure 'Allow Telemetry' is set to 'Enabled - 0 - Security [Enterprise Only]' or 'Enabled - 1 - Basic'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Datacollection
    name: "AllowTelemetry"
    data: "0"
    type: dword

- name: "18.9.16.3,CCE-Null | Ensure 'Do not show feedback notifications' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Datacollection
    name: "DoNotShowFeedbackNotifications"
    data: "1"
    type: dword

- name: "18.9.16.4,CCE-Null | Ensure 'Toggle user control over Insider builds' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Previewbuilds
    name: "AllowBuildPreview"
    data: "0"
    type: dword

- name: "18.9.26.1.1,CCE-37775-4 | Ensure 'Application - Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Eventlog\Application
    name: "Retention"
    data: "0"
    type: string

- name: "18.9.26.1.2,CCE-37948-7 | Ensure 'Application - Specify the maximum log file size (KB)' is set to 'Enabled - 32,768 or greater' [ITS-65,538 or greater]"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Eventlog\Application
    name: "MaxSize"
    data: "65538"
    type: dword

- name: "18.9.26.2.1,CCE-37145-0 | Ensure 'Security - Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Eventlog\Security
    name: "Retention"
    data: "0"
    type: string

- name: "18.9.26.2.2,CCE-37695-4 | Ensure 'Security - Specify the maximum log file size (KB)' is set to 'Enabled - 196,608 or greater'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Eventlog\Security
    name: "MaxSize"
    data: "196608"
    type: dword

- name: "18.9.26.3.1,CCE-38276-2 | Ensure 'Setup - Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Eventlog\Setup
    name: "Retention"
    data: "0"
    type: string

- name: "18.9.26.3.2,CCE-37526-1 | Ensure 'Setup - Specify the maximum log file size (KB)' is set to 'Enabled - 32,768 or greater'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Eventlog\Setup
    name: "MaxSize"
    data: "32768"
    type: dword

- name: "18.9.26.4.1,CCE-36160-0 | Ensure 'System - Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Eventlog\System
    name: "Retention"
    data: "0"
    type: string

- name: "18.9.26.4.2,CCE-36092-5 | Ensure 'System - Specify the maximum log file size (KB)' is set to 'Enabled - 32,768 or greater' [ITS-65,538 or greater]"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Eventlog\System
    name: "MaxSize"
    data: "65538"
    type: dword

- name: "18.9.30.2,CCE-37809-1 | Ensure 'Turn off Data Execution Prevention for Explorer' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Explorer
    name: "NoDataExecutionPrevention"
    data: "0"
    type: dword

- name: "18.9.30.3,CCE-36660-9 | Ensure 'Turn off heap termination on corruption' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Explorer
    name: "NoHeapTerminationOnCorruption"
    data: "0"
    type: dword

- name: "18.9.30.4,CCE-36809-2 | Ensure 'Turn off shell protocol protected mode' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Microsoft\Windows\Currentversion\Policies\Explorer
    name: "PreXPSP2ShellProtocolBehavior"
    data: "0"
    type: dword

- name: "18.9.44.1,CCE-Null | Ensure 'Block all consumer Microsoft account user authentication' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\MicrosoftAccount
    name: "DisableUserAuth"
    data: "1"
    type: dword

- name: "18.9.52.1,CCE-36939-7 | Ensure 'Prevent the usage of OneDrive (formerly SkyDrive) for file storage' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Onedrive
    name: "DisableFileSyncNGSC"
    data: "1"
    type: dword

- name: "18.9.59.2.2,CCE-36223-6 | Ensure 'Do not allow passwords to be saved' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Nt\Terminal Services
    name: "DisablePasswordSaving"
    data: "1"
    type: dword

- name: "18.9.59.3.3.2,CCE-36509-8 | Ensure 'Do not allow drive redirection' is set to 'Enabled' (ITS Enabled)"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Nt\Terminal Services
    name: "fDisableCdm"
    data: "0"
    type: dword

- name: "18.9.59.3.9.1,CCE-37929-7 | Ensure 'Always prompt for password upon connection' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Nt\Terminal Services
    name: "fPromptForPassword"
    data: "1"
    type: dword

- name: "18.9.59.3.9.2,CCE-37567-5 | Ensure 'Require secure RPC communication' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Nt\Terminal Services
    name: "fEncryptRPCTraffic"
    data: "1"
    type: dword

- name: "18.9.59.3.9.3,CCE-36598-1 | Ensure 'Require use of specific security layer for remote (RDP) connections' is set to 'Enabled - SSL'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows NT\Terminal Services
    name: "SecurityLayer"
    data: "2"
    type: dword

- name: "18.9.59.3.9.4,CCE-37330-8 | Ensure 'Require user authentication for remote connections by using Network Level Authentication' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows NT\Terminal Services
    name: "UserAuthentication"
    data: "1"
    type: dword

- name: "18.9.59.3.9.5,CCE-36627-8 | Ensure 'Set client connection encryption level' is set to 'Enabled - High Level'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Nt\Terminal Services
    name: "MinEncryptionLevel"
    data: "3"
    type: dword

- name: "18.9.59.3.11.1,CCE-37946-1 | Ensure 'Do not delete temp folders upon exit' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Nt\Terminal Services
    name: "DeleteTempDirsOnExit"
    data: "1"
    type: dword

- name: "18.9.59.3.11.2,CCE-38180-6 | Ensure 'Do not use temporary folders per session' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Nt\Terminal Services
    name: "PerSessionTempDir"
    data: "1"
    type: dword

- name: "18.9.60.1,CCE-37126-0 | Ensure 'Prevent downloading of enclosures' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Internet Explorer\Feeds
    name: "DisableEnclosureDownload"
    data: "1"
    type: dword

- name: "18.9.61.3,CCE-38277-0 | Ensure 'Allow indexing of encrypted files' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Windows Search
    name: "AllowIndexingEncryptedStoresOrItems"
    data: "0"
    type: dword

- name: "18.9.77.15,CCE-Null | Ensure 'Turn off Windows Defender AntiVirus' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender
    name: "DisableAntiSpyware"
    data: "0"
    type: dword

- name: "18.9.77.14,CCE-Null | Ensure 'Configure detection for potentially unwanted applications' is set to 'Enabled - Block'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender
    name: "PUAProtection"
    data: "1"
    type: dword

- name: "18.9.77.3.1,CCE-36940-5 | Ensure 'Configure local setting override for reporting to Microsoft MAPS' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Spynet
    name: "LocalSettingOverrideSpynetReporting"
    data: "0"
    type: dword

- name: "18.9.77.7.1,CCE-38389-3 | Ensure 'Turn on behavior monitoring' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection
    name: "DisableBehaviorMonitoring"
    data: "0"
    type: dword

- name: "18.9.77.10.1,CCE-38409-9 | Ensure 'Scan removable drives' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Scan
    name: "DisableRemovableDriveScanning"
    data: "0"
    type: dword

- name: "18.9.77.10.2,CCE-36958-7 | Ensure 'Turn on e-mail scanning' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Scan
    name: "DisableEmailScanning"
    data: "0"
    type: dword

- name: "18.9.77.13.1.1,CCE-Null | Ensure 'Configure Attack Surface Reduction rules' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR
    name: "ExploitGuard_ASR_Rules"
    data: "1"
    type: dword

- name: "18.9.77.13.1.2,CCE-Null | Ensure 'Configure Attack Surface Reduction rules - Set the state for each ASR rule' is 'configured' - 26190899-1602-49e8-8b27-eb1d0a1ce869"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
    name: "26190899-1602-49e8-8b27-eb1d0a1ce869"
    data: "1"
    type: string

- name: "18.9.77.13.1.2,CCE-Null | Ensure 'Configure Attack Surface Reduction rules - Set the state for each ASR rule' is 'configured' - 3b576869-a4ec-4529-8536-b80a7769e899"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
    name: "3b576869-a4ec-4529-8536-b80a7769e899"
    data: "1"
    type: string

- name: "18.9.77.13.1.2,CCE-Null | Ensure 'Configure Attack Surface Reduction rules - Set the state for each ASR rule' is 'configured' - 5beb7efe-fd9a-4556-801d-275e5ffc04cc"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
    name: "5beb7efe-fd9a-4556-801d-275e5ffc04cc"
    data: "1"
    type: string

- name: "18.9.77.13.1.2,CCE-Null | Ensure 'Configure Attack Surface Reduction rules - Set the state for each ASR rule' is 'configured' - 75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
    name: "75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84"
    data: "1"
    type: string

- name: "18.9.77.13.1.2,CCE-Null | Ensure 'Configure Attack Surface Reduction rules - Set the state for each ASR rule' is 'configured' - 7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
    name: "7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c"
    data: "1"
    type: string

- name: "18.9.77.13.1.2,CCE-Null | Ensure 'Configure Attack Surface Reduction rules - Set the state for each ASR rule' is 'configured' - 92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
    name: "92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b"
    data: "1"
    type: string

- name: "18.9.77.13.1.2,CCE-Null | Ensure 'Configure Attack Surface Reduction rules - Set the state for each ASR rule' is 'configured' - 9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
    name: "9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2"
    data: "1"
    type: string

- name: "18.9.77.13.1.2,CCE-Null | Ensure 'Configure Attack Surface Reduction rules - Set the state for each ASR rule' is 'configured' - b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
    name: "b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4"
    data: "1"
    type: string

- name: "18.9.77.13.1.2,CCE-Null | Ensure 'Configure Attack Surface Reduction rules - Set the state for each ASR rule' is 'configured' - be9ba2d9-53ea-4cdc-84e5-9b1eeee46550"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
    name: "be9ba2d9-53ea-4cdc-84e5-9b1eeee46550"
    data: "1"
    type: string

- name: "18.9.77.13.1.2,CCE-Null | Ensure 'Configure Attack Surface Reduction rules - Set the state for each ASR rule' is 'configured' - d3e037e1-3eb8-44c8-a917-57927947596d"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
    name: "d3e037e1-3eb8-44c8-a917-57927947596d"
    data: "1"
    type: string

- name: "18.9.77.13.1.2,CCE-Null | Ensure 'Configure Attack Surface Reduction rules - Set the state for each ASR rule' is 'configured' - d4f940ab-401b-4efc-aadc-ad5f3c50688a"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules
    name: "d4f940ab-401b-4efc-aadc-ad5f3c50688a"
    data: "1"
    type: string

- name: "18.9.77.13.3.1,CCE-Null | Ensure 'Prevent users and apps from accessing dangerous websites' is set to 'Enabled - Block'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\Network Protection
    name: "EnableNetworkProtection"
    data: "1"
    type: dword

- name: "18.9.80.1.1,CCE-35859-8 | Ensure 'Configure Windows Defender SmartScreen' is set to 'Enabled - Warn and prevent bypass' - EnableSmartScreen"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\System
    name: "EnableSmartScreen"
    data: "1"
    type: dword

- name: "18.9.80.1.1,CCE-35859-8 | Ensure 'Configure Windows Defender SmartScreen' is set to 'Enabled - Warn and prevent bypass' - ShellSmartScreenLevel"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\System
    name: "ShellSmartScreenLevel"
    data: "Block"
    type: string

- name: "18.9.84.2,CCE-Null | Ensure 'Allow Windows Ink Workspace' is set to 'Enabled - On, but disallow access above lock' OR 'Disabled' but not 'Enabled - On'"
  win_regedit:
    path: HKLM:\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace
    name: "AllowWindowsInkWorkspace"
    data: "1"
    type: dword

- name: "18.9.85.1,CCE-36400-0 | Ensure 'Allow user control over installs' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Installer
    name: "EnableUserControl"
    data: "0"
    type: dword

- name: "18.9.85.2,CCE-36919-9 | Ensure 'Always install with elevated privileges' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Installer
    name: "AlwaysInstallElevated"
    data: "0"
    type: dword

- name: "18.9.86.1,CCE-36977-7 | Ensure 'Sign-in and lock last interactive user automatically after a restart' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Microsoft\Windows\Currentversion\Policies\System
    name: "DisableAutomaticRestartSignOn"
    data: "1"
    type: dword

- name: "18.9.99.2.1,CCE-Null | Ensure 'Prevent users from modifying settings' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows Defender Security Center\App and Browser protection
    name: "DisallowExploitProtectionOverride"
    data: "1"
    type: dword

#########################
## POWERSHELL SETTINGS ##
#########################

- name: "CIS-Null,CCE-Null | Ensure 'Turn on PowerShell Module Logging' is set to 'Enabled, Modules=*'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Powershell\ModuleLogging
    name: "EnableModuleLogging"
    data: "1"
    type: dword

- name: "18.9.95.1,CCE-Null | Ensure 'Turn on PowerShell Script Block Logging' is set to 'Disabled' [ITS-Enabled]"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Powershell\Scriptblocklogging
    name: "EnableScriptBlockLogging"
    data: "0"
    type: dword

- name: "18.9.95.2,CCE-Null | Ensure 'Turn on PowerShell Transcription' is set to 'Disabled' [ITS-Enabled]"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Powershell\Transcription
    name: "EnableTranscripting"
    data: "0"
    type: dword

####################
## WINRM SETTINGS ##
####################

- name: "18.9.97.1.1,CCE-36310-1 | Ensure 'Allow Basic authentication' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Winrm\Client
    name: "AllowBasic"
    data: "0"
    type: dword

- name: "18.9.97.1.2,CCE-37726-7 | Ensure 'Allow unencrypted traffic' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Winrm\Client
    name: "AllowUnencryptedTraffic"
    data: "0"
    type: dword

- name: "18.9.97.1.3,CCE-38318-2 | Ensure 'Disallow Digest authentication' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Winrm\Client
    name: "AllowDigest"
    data: "0"
    type: dword

- name: "18.9.97.2.1,CCE-36254-1 | Ensure 'Allow Basic authentication' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Winrm\Service
    name: "AllowBasic"
    data: "0"
    type: dword

- name: "18.9.97.2.3,CCE-38223-4 | Ensure 'Allow unencrypted traffic' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Winrm\Service
    name: "AllowUnencryptedTraffic"
    data: "0"
    type: dword

- name: "18.9.97.2.4,CCE-36000-8 | Ensure 'Disallow WinRM from storing RunAs credentials' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Winrm\Service
    name: "DisableRunAs"
    data: "1"
    type: dword

  #This control will have to be set to Enabled (1) to allow for continued remote management via Ansible following machine restart
- name: "18.9.97.2.2,CCE-37927-1 | Ensure 'Allow remote server management through WinRM' is set to 'Disabled' (ITS Custom)"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Winrm\Service
    name: "AllowAutoConfig"
    data: "1"
    type: dword

  #This control will have to be set to Enabled (1) to allow for continued remote management via Ansible following machine restart
- name: "18.9.98.1,CCE-36499-2 | Ensure 'Allow Remote Shell Access' is set to 'Disabled' (ITS Custom)"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Winrm\Service\Winrs
    name: "AllowRemoteShellAccess"
    data: "1"
    type: dword

###############################
## WINDOWS FIREWALL SETTINGS ##
###############################

- name: "CIS-Null,CCE-Null | Ensure 'Windows Firewall: Domain: Settings: Apply local firewall rules' is set to 'Yes'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\DomainProfile
    name: "AllowLocalPolicyMerge"
    data: "1"
    type: dword

- name: "CIS-Null,CCE-Null | Ensure 'Windows Firewall: Private: Settings: Apply local firewall rules' is set to 'Yes'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile
    name: "AllowLocalPolicyMerge"
    data: "1"
    type: dword

- name: "9.1.1,CCE-36062-8 | Ensure 'Windows Firewall: Domain: Firewall state' is set to 'On"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\DomainProfile
    name: "EnableFirewall"
    data: "1"
    type: dword

- name: "9.1.2,CCE-38117-8 | Ensure 'Windows Firewall: Domain: Inbound connections' is set to 'Block'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\DomainProfile
    name: "DefaultInboundAction"
    data: "1"
    type: dword

- name: "9.1.3,CCE-36146-9 | Ensure 'Windows Firewall: Domain: Outbound connections' is set to 'Allow'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\DomainProfile
    name: "DefaultOutboundAction"
    data: "0"
    type: dword

- name: "9.1.4,CCE-38041-0 | Ensure 'Windows Firewall: Domain: Settings: Display a notification' is set to 'No'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\DomainProfile
    name: "DisableNotifications"
    data: "1"
    type: dword

- name: "9.1.5,CCE-37482-7 | Ensure 'Windows Firewall: Domain: Logging: Name' is set to '%SystemRoot% System32 logfiles firewall domainfw.log'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging
    name: "LogFilePath"
    data: '%SystemRoot%\System32\logfiles\firewall\domainfw.log'
    type: string

- name: "9.1.6,CCE-36088-3 | Ensure 'Windows Firewall: Domain: Logging: Size limit (KB)' is set to '16,384 KB or greater'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging
    name: "LogFileSize"
    data: "16384"
    type: dword

- name: "9.1.7,CCE-37523-8 | Ensure 'Windows Firewall: Domain: Logging: Log dropped packets' is set to 'Yes'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging
    name: "LogDroppedPackets"
    data: "1"
    type: dword

- name: "9.1.8,CCE-36393-7 | Ensure 'Windows Firewall: Domain: Logging: Log successful connections' is set to 'Yes'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\DomainProfile\Logging
    name: "LogSuccessfulConnections"
    data: "1"
    type: dword

- name: "9.2.1,CCE-38239-0 | Ensure 'Windows Firewall: Private: Firewall state' is set to 'On'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile
    name: "EnableFirewall"
    data: "1"
    type: dword

- name: "9.2.2,CCE-38042-8 | Ensure 'Windows Firewall: Private: Inbound connections' is set to 'Block'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile
    name: "DefaultInboundAction"
    data: "1"
    type: dword

- name: "9.2.3,CCE-38332-3 | Ensure 'Windows Firewall: Private: Outbound connections' is set to 'Allow'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile
    name: "DefaultOutboundAction"
    data: "0"
    type: dword

- name: "9.2.4,CCE-37621-0 | Ensure 'Windows Firewall: Private: Settings: Display a notification' is set to 'No'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile
    name: "DisableNotifications"
    data: "1"
    type: dword

- name: "9.2.5,CCE-37569-1 | Ensure 'Windows Firewall: Private: Logging: Name' is set to '%SystemRoot% System32 logfiles firewall privatefw.log'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging
    name: "LogFilePath"
    data: '%SystemRoot%\System32\logfiles\firewall\privatefw.log'
    type: string

- name: "9.2.6,CCE-38178-0 | Ensure 'Windows Firewall: Private: Logging: Size limit (KB)' is set to '16,384 KB or greater'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging
    name: "LogFileSize"
    data: "16384"
    type: dword

- name: "9.2.7,CCE-35972-9 | Ensure 'Windows Firewall: Private: Logging: Log dropped packets' is set to 'Yes'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging
    name: "LogDroppedPackets"
    data: "1"
    type: dword

- name: "9.2.8,CCE-37387-8 | Ensure 'Windows Firewall: Private: Logging: Log successful connections' is set to 'Yes'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile\Logging
    name: "LogSuccessfulConnections"
    data: "1"
    type: dword

- name: "9.3.1,CCE-37862-0 | Ensure 'Windows Firewall: Public: Firewall state' is set to 'On'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PublicProfile
    name: "EnableFirewall"
    data: "1"
    type: dword

- name: "9.3.2,CCE-36057-8 | Ensure 'Windows Firewall: Public: Inbound connections' is set to 'Block'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PublicProfile
    name: "DefaultInboundAction"
    data: "1"
    type: dword

- name: "9.3.3,CCE-37434-8 | Ensure 'Windows Firewall: Public: Outbound connections' is set to 'Allow'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PublicProfile
    name: "DefaultOutboundAction"
    data: "0"
    type: dword

- name: "9.3.4,CCE-38043-6 | Ensure 'Windows Firewall: Public: Settings: Display a notification' is set to 'No'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PublicProfile
    name: "DisableNotifications"
    data: "1"
    type: dword

- name: "9.3.5,CCE-37861-2 | Ensure 'Windows Firewall: Public: Settings: Apply local firewall rules' is set to 'No'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PublicProfile
    name: "AllowLocalPolicyMerge"
    data: "0"
    type: dword

- name: "9.3.6,CCE-36268-1 | Ensure 'Windows Firewall: Public: Settings: Apply local connection security rules' is set to 'No'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PublicProfile
    name: "AllowLocalIPsecPolicyMerge"
    data: "0"
    type: dword

- name: "9.3.7,CCE-37266-4 | Ensure 'Windows Firewall: Public: Logging: Name' is set to '%SystemRoot% System32 logfiles firewall publicfw.log'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging
    name: "LogFilePath"
    data: '%SystemRoot%\System32\logfiles\firewall\publicfw.log'
    type: string

- name: "9.3.8,CCE-36395-2 | Ensure 'Windows Firewall: Public: Logging: Size limit (KB)' is set to '16,384 KB or greater'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging
    name: "LogFileSize"
    data: "16384"
    type: dword

- name: "9.3.9,CCE-37265-6 | Ensure 'Windows Firewall: Public: Logging: Log dropped packets' is set to 'Yes'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging
    name: "LogDroppedPackets"
    data: "1"
    type: dword

- name: "9.3.10,CCE-36394-5 | Ensure 'Windows Firewall: Public: Logging: Log successful connections' is set to 'Yes'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\WindowsFirewall\PublicProfile\Logging
    name: "LogSuccessfulConnections"
    data: "1"
    type: dword

#############################
## WINDOWS UPDATE SETTINGS ##
#############################

- name: "18.9.102.2,CCE-36172-5 | Ensure 'Configure Automatic Updates' is set to 'Enabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Windowsupdate\Au
    name: "NoAutoUpdate"
    data: "0"
    type: dword

- name: "18.9.102.3,CCE-36172-5 | Ensure 'Configure Automatic Updates - Scheduled install day' is set to '0 - Every day'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Windowsupdate\Au
    name: "ScheduledInstallDay"
    data: "0"
    type: dword

- name: "18.9.102.4,CCE-37027-0 | Ensure 'No auto-restart with logged on users for scheduled automatic updates installations' is set to 'Disabled'"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\Windowsupdate\Au
    name: "NoAutoRebootWithLoggedOnUsers"
    data: "0"
    type: dword

- name: "18.9.102.1.1,CCE-Null | Ensure 'Manage preview builds' is set to 'Enabled - Disable preview builds' - ManagePreviewBuilds"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate
    name: "ManagePreviewBuilds"
    data: "1"
    type: dword

- name: "18.9.102.1.1,CCE-Null | Ensure 'Manage preview builds' is set to 'Enabled - Disable preview builds' - ManagePreviewBuildsPolicyValue"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate
    name: "ManagePreviewBuildsPolicyValue"
    data: "0"
    type: dword

- name: "18.9.102.1.2,CCE-Null | Ensure 'Select when Preview Builds and Feature Updates are received' is set to 'Enabled - Semi-Annual Channel, 180 or more days' - DeferFeatureUpdates"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate
    name: "DeferFeatureUpdates"
    data: "1"
    type: dword

- name: "18.9.102.1.2,CCE-Null | Ensure 'Select when Preview Builds and Feature Updates are received' is set to 'Enabled - Semi-Annual Channel, 180 or more days' - DeferFeatureUpdatesPeriodInDays"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate
    name: "DeferFeatureUpdatesPeriodInDays"
    data: "180"
    type: dword

- name: "18.9.102.1.2,CCE-Null | Ensure 'Select when Preview Builds and Feature Updates are received' is set to 'Enabled - Semi-Annual Channel, 180 or more days' - BranchReadinessLevel"
  win_regedit:
    path: HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate
    name: "BranchReadinessLevel"
    data: "32"
    type: dword

- name: "18.9.102.1.3,CCE-Null | Ensure 'Select when Quality Updates are received' is set to 'Enabled - 0 days' - DeferQualityUpdates"
  win_regedit:
    path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate
    name: "DeferQualityUpdates"
    data: "1"
    type: dword

- name: "18.9.102.1.3,CCE-Null | Ensure 'Select when Quality Updates are received' is set to 'Enabled - 0 days' - DeferQualityUpdatesPeriodInDays"
  win_regedit:
    path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate
    name: "DeferQualityUpdatesPeriodInDays"
    data: "0"
    type: dword

##########################
##########################
## CIS LEVEL 1 SETTINGS ##
##########################
##########################

##########################
## USER CONFIG SETTINGS ##
##########################

- name: "19.1.3.1,CCE-37970-1 | Ensure 'Enable screen saver' is set to 'Enabled'"
  win_regedit:
    path: HKCU:\Software\Policies\Microsoft\Windows\Control Panel\Desktop
    name: "ScreenSaveActive"
    data: "1"
    type: string

- name: "19.1.3.1,CCE-37970-1 | Ensure 'Enable screen saver' is set to 'Enabled'"
  win_regedit:
    path: HKU:\.DEFAULT\Software\Policies\Microsoft\Windows\Control Panel\Desktop
    name: "ScreenSaveActive"
    data: "1"
    type: string

- name: "19.1.3.2,CCE-37907-3 | Ensure 'Force specific screen saver - Screen saver executable name' is set to 'Enabled - scrnsave.scr'"
  win_regedit:
    path: HKCU:\Software\Policies\Microsoft\Windows\Control Panel\Desktop
    name: "SCRNSAVE.EXE"
    data: "scrnsave.scr"
    type: string

- name: "19.1.3.2,CCE-37907-3 | Ensure 'Force specific screen saver - Screen saver executable name' is set to 'Enabled - scrnsave.scr'"
  win_regedit:
    path: HKU:\.DEFAULT\Software\Policies\Microsoft\Windows\Control Panel\Desktop
    name: "SCRNSAVE.EXE"
    data: "scrnsave.scr"
    type: string

- name: "19.1.3.3,CCE-37658-2 | Ensure 'Password protect the screen saver' is set to 'Enabled'"
  win_regedit:
    path: HKCU:\Software\Policies\Microsoft\Windows\Control Panel\Desktop
    name: "ScreenSaverIsSecure"
    data: "1"
    type: string

- name: "19.1.3.3,CCE-37658-2 | Ensure 'Password protect the screen saver' is set to 'Enabled'"
  win_regedit:
    path: HKU:\.DEFAULT\Software\Policies\Microsoft\Windows\Control Panel\Desktop
    name: "ScreenSaverIsSecure"
    data: "1"
    type: string

- name: "19.1.3.4,CCE-37908-1 | Ensure 'Screen saver timeout' is set to 'Enabled - 900 seconds or fewer, but not 0'"
  win_regedit:
    path: HKCU:\Software\Policies\Microsoft\Windows\Control Panel\Desktop
    name: "ScreenSaveTimeOut"
    data: "900"
    type: string

- name: "19.1.3.4,CCE-37908-1 | Ensure 'Screen saver timeout' is set to 'Enabled - 900 seconds or fewer, but not 0'"
  win_regedit:
    path: HKU:\.DEFAULT\Software\Policies\Microsoft\Windows\Control Panel\Desktop
    name: "ScreenSaveTimeOut"
    data: "900"
    type: string

- name: "19.5.1.1,CCE-36332-5 | Ensure 'Turn off toast notifications on the lock screen' is set to 'Enabled'"
  win_regedit:
    path: HKCU:\Software\Policies\Microsoft\Windows\Currentversion\Pushnotifications
    name: "NoToastApplicationNotificationOnLockScreen"
    data: "1"
    type: dword

- name: "19.5.1.1,CCE-36332-5 | Ensure 'Turn off toast notifications on the lock screen' is set to 'Enabled'"
  win_regedit:
    path: HKU:\.DEFAULT\Software\Policies\Microsoft\Windows\Currentversion\Pushnotifications
    name: "NoToastApplicationNotificationOnLockScreen"
    data: "1"
    type: dword

- name: "19.7.4.1,CCE-37424-9 | Ensure 'Do not preserve zone information in file attachments' is set to 'Disabled'"
  win_regedit:
    path: HKCU:\Software\Microsoft\Windows\Currentversion\Policies\Attachments
    name: "SaveZoneInformation"
    data: "2"
    type: dword

- name: "19.7.4.1,CCE-37424-9 | Ensure 'Do not preserve zone information in file attachments' is set to 'Disabled'"
  win_regedit:
    path: HKU:\.DEFAULT\Software\Microsoft\Windows\Currentversion\Policies\Attachments
    name: "SaveZoneInformation"
    data: "2"
    type: dword

- name: "19.7.4.2,CCE-36622-9 | Ensure 'Notify antivirus programs when opening attachments' is set to 'Enabled'"
  win_regedit:
    path: HKCU:\Software\Microsoft\Windows\Currentversion\Policies\Attachments
    name: "ScanWithAntiVirus"
    data: "3"
    type: dword

- name: "19.7.4.2,CCE-36622-9 | Ensure 'Notify antivirus programs when opening attachments' is set to 'Enabled'"
  win_regedit:
    path: HKU:\.DEFAULT\Software\Microsoft\Windows\Currentversion\Policies\Attachments
    name: "ScanWithAntiVirus"
    data: "3"
    type: dword

- name: "19.7.7.1,CCE-Null | Ensure 'Configure Windows spotlight on Lock Screen' is set to Disabled'"
  win_regedit:
    path: HKCU:\Software\Policies\Microsoft\Windows\CloudContent
    name: "ConfigureWindowsSpotlight"
    data: "2"
    type: dword

- name: "19.7.7.1,CCE-Null | Ensure 'Configure Windows spotlight on Lock Screen' is set to Disabled'"
  win_regedit:
    path: HKU:\.DEFAULT\Software\Policies\Microsoft\Windows\CloudContent
    name: "ConfigureWindowsSpotlight"
    data: "2"
    type: dword

- name: "19.7.7.2,CCE-Null | Ensure 'Do not suggest third-party content in Windows spotlight' is set to 'Enabled'"
  win_regedit:
    path: HKCU:\Software\Policies\Microsoft\Windows\CloudContent
    name: "DisableThirdPartySuggestions"
    data: "1"
    type: dword

- name: "19.7.7.2,CCE-Null | Ensure 'Do not suggest third-party content in Windows spotlight' is set to 'Enabled'"
  win_regedit:
    path: HKU:\.DEFAULT\Software\Policies\Microsoft\Windows\CloudContent
    name: "DisableThirdPartySuggestions"
    data: "1"
    type: dword

- name: "19.7.26.1,CCE-38070-9 | Ensure 'Prevent users from sharing files within their profile.' is set to 'Enabled'"
  win_regedit:
    path: HKCU:\Software\Microsoft\Windows\Currentversion\Policies\Explorer
    name: "NoInplaceSharing"
    data: "1"
    type: dword

- name: "19.7.26.1,CCE-38070-9 | Ensure 'Prevent users from sharing files within their profile.' is set to 'Enabled'"
  win_regedit:
    path: HKU:\.DEFAULT\Software\Microsoft\Windows\Currentversion\Policies\Explorer
    name: "NoInplaceSharing"
    data: "1"
    type: dword

- name: "19.7.41.1,CCE-37490-0 | Ensure 'Always install with elevated privileges' is set to 'Disabled'"
  win_regedit:
    path: HKCU:\Software\Policies\Microsoft\Windows\Installer
    name: "AlwaysInstallElevated"
    data: "0"
    type: dword

- name: "19.7.41.1,CCE-37490-0 | Ensure 'Always install with elevated privileges' is set to 'Disabled'"
  win_regedit:
    path: HKU:\.DEFAULT\Software\Policies\Microsoft\Windows\Installer
    name: "AlwaysInstallElevated"
    data: "0"
    type: dword
